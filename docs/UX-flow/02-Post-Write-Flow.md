# Post Write Flow (글쓰기 플로우)

## 개요
사용자가 게시글을 작성하고 게시하는 전체 플로우입니다. 임시저장 기능을 포함합니다.

## 플로우 다이어그램

```
[게시글 작성 페이지 접근]
    |
    ├─ [로그인 확인]
    |     ├─ 미로그인 → 로그인 페이지로 리다이렉트
    |     └─ 로그인됨 → 작성 페이지 표시
    |
    ├─ [게시글 작성 폼]
    |     |
    |     ├─ [카테고리 선택]
    |     ├─ [제목 입력]
    |     ├─ [내용 입력]
    |     ├─ [이미지 업로드 (선택)]
    |     |     |
    |     |     ├─ [이미지 선택]
    |     |     ├─ [이미지 업로드 API 호출]
    |     |     |     ├─ 실패 → 에러 메시지 표시
    |     |     |     └─ 성공 → 미리보기 표시
    |     |
    |     └─ [작성 버튼]
    |           |
    |           ├─ [임시저장]
    |           |     |
    |           |     ├─ [유효성 검사 (제목/내용 없어도 가능)]
    |           |     ├─ [API 호출: POST /api/posts (status=draft)]
    |           |     |     ├─ 실패 → 에러 메시지 표시
    |           |     |     └─ 성공 → "임시저장되었습니다" 메시지
    |           |
    |           └─ [게시하기]
    |                 |
    |                 ├─ [유효성 검사]
    |                 |     ├─ 제목 없음 → 에러 메시지
    |                 |     ├─ 내용 없음 → 에러 메시지
    |                 |     └─ 통과
    |                 |
    |                 ├─ [API 호출: POST /api/posts]
    |                 |     ├─ 실패 → 에러 메시지 표시
    |                 |     └─ 성공 → 게시글 상세 페이지로 리다이렉트
    |
    └─ [게시 완료]
          |
          └─ [게시글 상세 페이지 표시]
```

## 상세 시나리오

### 시나리오 1: 게시글 작성 및 게시 성공

1. 사용자가 "글쓰기" 버튼 클릭
2. 로그인 상태 확인
3. 게시글 작성 페이지 표시
4. 카테고리 선택 (선택사항)
5. 제목 입력
6. 내용 입력 (텍스트 에디터 사용)
7. 이미지 업로드 (선택사항)
   - 이미지 파일 선택
   - 이미지 업로드 API 호출
   - 업로드 성공 시 미리보기 표시
8. "게시하기" 버튼 클릭
9. 프론트엔드에서 유효성 검사
   - 제목 필수 확인
   - 내용 필수 확인
10. `/api/posts` API 호출 (POST)
11. 백엔드에서 게시글 생성
12. 게시글 ID 반환
13. 게시글 상세 페이지로 리다이렉트 (`/posts/{id}`)

### 시나리오 2: 임시저장

1. 사용자가 게시글 작성 중
2. "임시저장" 버튼 클릭
3. 제목/내용 없어도 가능 (유효성 검사 완화)
4. `/api/posts` API 호출 (status=draft)
5. 백엔드에서 임시저장 게시글 생성
6. "임시저장되었습니다" 메시지 표시
7. 사용자가 나중에 다시 편집 가능

### 시나리오 3: 이미지 업로드 실패

1. 사용자가 이미지 파일 선택
2. 이미지 업로드 API 호출
3. 파일 크기 초과 또는 형식 오류
4. 에러 메시지 표시: "이미지 업로드에 실패했습니다. (최대 5MB, JPG/PNG만 가능)"
5. 사용자가 다른 이미지 선택 또는 계속 진행

### 시나리오 4: 작성 중 페이지 이탈

1. 사용자가 게시글 작성 중
2. 브라우저 뒤로가기 또는 다른 페이지로 이동 시도
3. 내용이 있는 경우 확인 다이얼로그 표시
   - "작성 중인 내용이 있습니다. 정말 나가시겠습니까?"
   - 취소: 작성 페이지 유지
   - 확인: 임시저장 제안 또는 페이지 이탈

### 시나리오 5: 게시 실패 (네트워크 오류)

1. 사용자가 "게시하기" 버튼 클릭
2. API 호출 중 네트워크 오류 발생
3. 에러 메시지 표시: "네트워크 오류가 발생했습니다."
4. "다시 시도" 버튼 제공
5. 작성한 내용은 유지 (로컬 스토리지 또는 상태 관리)

## 예외 처리

### 유효성 검사 실패
- **제목 없음**: "제목을 입력해주세요." 메시지 표시, 제목 입력 필드 포커스
- **내용 없음**: "내용을 입력해주세요." 메시지 표시, 내용 입력 필드 포커스
- **제목 길이 초과**: "제목은 500자 이하로 입력해주세요." 메시지 표시

### 이미지 업로드 제한
- **파일 크기 초과**: "이미지는 5MB 이하만 업로드 가능합니다."
- **지원하지 않는 형식**: "JPG, PNG 형식만 지원합니다."
- **이미지 개수 초과**: "이미지는 최대 10개까지 업로드 가능합니다."

### 권한 오류
- **로그인 필요**: 로그인 페이지로 리다이렉트
- **카테고리 권한 없음**: "해당 카테고리에 글을 작성할 권한이 없습니다."

### 서버 오류
- **500 에러**: "서버 오류가 발생했습니다. 잠시 후 다시 시도해주세요."
- **타임아웃**: "요청 시간이 초과되었습니다. 다시 시도해주세요."

## UX 고려사항

1. **자동 저장**: 일정 시간마다 자동으로 임시저장 (선택사항)
2. **드래그 앤 드롭**: 이미지를 드래그 앤 드롭으로 업로드 가능
3. **미리보기**: 이미지 업로드 후 즉시 미리보기 표시
4. **글자 수 카운터**: 제목/내용 글자 수 실시간 표시
5. **마크다운 지원**: 마크다운 형식 지원 (선택사항)
6. **모바일 최적화**: 모바일에서도 편리하게 작성 가능

## 성능 최적화

1. **이미지 압축**: 클라이언트에서 이미지 압축 후 업로드
2. **점진적 업로드**: 이미지를 하나씩 업로드하여 사용자 경험 개선
3. **로컬 스토리지**: 작성 중인 내용을 로컬 스토리지에 저장하여 페이지 새로고침 시 복구
4. **디바운싱**: 자동 저장 시 디바운싱 적용하여 API 호출 최소화

## 접근성

1. **키보드 네비게이션**: 모든 기능을 키보드로 접근 가능
2. **스크린 리더 지원**: 폼 요소에 적절한 라벨 및 ARIA 속성
3. **에러 메시지**: 스크린 리더가 읽을 수 있는 형태로 에러 메시지 제공

